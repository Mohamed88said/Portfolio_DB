<!-- Modal de recherche -->
<div class="modal fade" id="searchModal" tabindex="-1" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-enhanced">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="searchModalLabel">
                    <i class="fas fa-search me-2"></i>Rechercher
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="search-container">
                    <div class="input-group mb-3">
                        <span class="input-group-text">
                            <i class="fas fa-search"></i>
                        </span>
                        <input type="text" class="form-control form-control-lg" 
                               id="searchInput" 
                               placeholder="Rechercher dans le portfolio..."
                               autocomplete="off">
                        <button class="btn btn-outline-secondary" type="button" id="clearSearch">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="search-filters mb-3">
                        <small class="text-muted">Filtrer par :</small>
                        <div class="btn-group btn-group-sm ms-2" role="group">
                            <input type="radio" class="btn-check" name="searchFilter" id="filterAll" value="all" checked>
                            <label class="btn btn-outline-primary" for="filterAll">Tout</label>
                            
                            <input type="radio" class="btn-check" name="searchFilter" id="filterProjects" value="projects">
                            <label class="btn btn-outline-primary" for="filterProjects">Projets</label>
                            
                            <input type="radio" class="btn-check" name="searchFilter" id="filterSkills" value="skills">
                            <label class="btn btn-outline-primary" for="filterSkills">Compétences</label>
                            
                            <input type="radio" class="btn-check" name="searchFilter" id="filterExperience" value="experience">
                            <label class="btn btn-outline-primary" for="filterExperience">Expériences</label>
                        </div>
                    </div>
                </div>
                
                <div class="search-results" id="searchResults">
                    <div class="search-suggestions">
                        <h6 class="text-muted mb-3">Suggestions de recherche :</h6>
                        <div class="d-flex flex-wrap gap-2">
                            <span class="badge bg-light text-dark search-suggestion" data-query="Python">Python</span>
                            <span class="badge bg-light text-dark search-suggestion" data-query="Django">Django</span>
                            <span class="badge bg-light text-dark search-suggestion" data-query="React">React</span>
                            <span class="badge bg-light text-dark search-suggestion" data-query="Machine Learning">Machine Learning</span>
                            <span class="badge bg-light text-dark search-suggestion" data-query="Full Stack">Full Stack</span>
                        </div>
                    </div>
                    
                    <div class="search-no-results d-none" id="searchNoResults">
                        <div class="text-center py-4">
                            <i class="fas fa-search fa-3x text-muted mb-3"></i>
                            <h5 class="text-muted">Aucun résultat trouvé</h5>
                            <p class="text-muted">Essayez avec d'autres mots-clés</p>
                        </div>
                    </div>
                    
                    <div class="search-results-list" id="searchResultsList"></div>
                </div>
            </div>
            <div class="modal-footer">
                <small class="text-muted">
                    <i class="fas fa-lightbulb me-1"></i>
                    Astuce : Utilisez <kbd>Ctrl</kbd> + <kbd>K</kbd> pour ouvrir la recherche rapidement
                </small>
            </div>
        </div>
    </div>
</div>

<style>
.search-container .input-group-text {
    background: transparent;
    border-right: none;
}

.search-container .form-control {
    border-left: none;
    border-right: none;
    box-shadow: none;
}

.search-container .form-control:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.25);
}

.search-suggestion {
    cursor: pointer;
    transition: all 0.3s ease;
}

.search-suggestion:hover {
    background: var(--primary) !important;
    color: white !important;
    transform: translateY(-2px);
}

.search-result-item {
    padding: 15px;
    border: 1px solid #e9ecef;
    border-radius: 8px;
    margin-bottom: 10px;
    transition: all 0.3s ease;
    cursor: pointer;
}

.search-result-item:hover {
    border-color: var(--primary);
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.search-result-title {
    font-weight: 600;
    color: var(--primary);
    margin-bottom: 5px;
}

.search-result-type {
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.search-result-excerpt {
    color: #6c757d;
    font-size: 0.9rem;
}

.search-highlight {
    background: yellow;
    padding: 2px 4px;
    border-radius: 3px;
}

body.dark-mode .search-result-item {
    background: #2d2d2d;
    border-color: #404040;
}

body.dark-mode .search-result-excerpt {
    color: #adb5bd;
}

body.dark-mode .search-suggestion {
    background: #404040 !important;
    color: white !important;
}

kbd {
    background: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 3px;
    padding: 2px 6px;
    font-size: 0.8rem;
}

body.dark-mode kbd {
    background: #404040;
    border-color: #6c757d;
    color: white;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const searchModal = new bootstrap.Modal(document.getElementById('searchModal'));
    const searchInput = document.getElementById('searchInput');
    const searchResults = document.getElementById('searchResultsList');
    const searchNoResults = document.getElementById('searchNoResults');
    const clearSearch = document.getElementById('clearSearch');
    
    // Données de recherche (à adapter selon votre contenu)
    const searchData = [
        {
            title: 'EcoTrack - Application de Suivi Environnemental',
            type: 'Projet',
            excerpt: 'Application mobile et web pour suivre son empreinte carbone personnelle avec recommandations IA.',
            url: '/projects/1/',
            tags: ['Python', 'Django', 'React Native', 'IA', 'Environnement']
        },
        {
            title: 'SmartFinance - Plateforme de Gestion Financière',
            type: 'Projet',
            excerpt: 'Plateforme SaaS de gestion financière avec IA prédictive pour PME.',
            url: '/projects/2/',
            tags: ['Django', 'Vue.js', 'Machine Learning', 'Finance']
        },
        {
            title: 'Python',
            type: 'Compétence',
            excerpt: 'Langage de programmation - Niveau Expert - 5 ans d\'expérience',
            url: '/academic/',
            tags: ['Python', 'Programmation', 'Backend']
        },
        {
            title: 'Lead Developer Full Stack',
            type: 'Expérience',
            excerpt: 'TechCorp Solutions - Direction technique d\'une équipe de 5 développeurs',
            url: '/experience/',
            tags: ['Leadership', 'Full Stack', 'Django', 'React']
        }
    ];
    
    // Ouvrir la recherche avec Ctrl+K
    document.addEventListener('keydown', function(e) {
        if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
            e.preventDefault();
            searchModal.show();
            setTimeout(() => searchInput.focus(), 100);
        }
    });
    
    // Recherche en temps réel
    let searchTimeout;
    searchInput.addEventListener('input', function() {
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(() => {
            performSearch(this.value);
        }, 300);
    });
    
    // Suggestions de recherche
    document.querySelectorAll('.search-suggestion').forEach(suggestion => {
        suggestion.addEventListener('click', function() {
            searchInput.value = this.dataset.query;
            performSearch(this.dataset.query);
        });
    });
    
    // Effacer la recherche
    clearSearch.addEventListener('click', function() {
        searchInput.value = '';
        searchResults.innerHTML = '';
        searchNoResults.classList.add('d-none');
        document.querySelector('.search-suggestions').classList.remove('d-none');
    });
    
    function performSearch(query) {
        if (!query.trim()) {
            searchResults.innerHTML = '';
            searchNoResults.classList.add('d-none');
            document.querySelector('.search-suggestions').classList.remove('d-none');
            return;
        }
        
        document.querySelector('.search-suggestions').classList.add('d-none');
        
        const results = searchData.filter(item => {
            const searchText = (item.title + ' ' + item.excerpt + ' ' + item.tags.join(' ')).toLowerCase();
            return searchText.includes(query.toLowerCase());
        });
        
        if (results.length === 0) {
            searchResults.innerHTML = '';
            searchNoResults.classList.remove('d-none');
        } else {
            searchNoResults.classList.add('d-none');
            displayResults(results, query);
        }
    }
    
    function displayResults(results, query) {
        searchResults.innerHTML = results.map(result => `
            <div class="search-result-item" onclick="window.location.href='${result.url}'">
                <div class="search-result-title">${highlightText(result.title, query)}</div>
                <div class="search-result-type badge bg-secondary mb-2">${result.type}</div>
                <div class="search-result-excerpt">${highlightText(result.excerpt, query)}</div>
            </div>
        `).join('');
    }
    
    function highlightText(text, query) {
        if (!query) return text;
        const regex = new RegExp(`(${query})`, 'gi');
        return text.replace(regex, '<span class="search-highlight">$1</span>');
    }
});
</script>